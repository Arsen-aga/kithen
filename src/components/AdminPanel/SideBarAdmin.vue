<script setup>
import { startAnimation } from '@/helpers/logoAnimation'
import { ref, onMounted, onUnmounted } from 'vue'
const menuItems = ref([
  {
    name: 'Товары',
    category: '',
    subcategories: [
      { name: 'Категории товаров', category: 'product-groups' },
      { name: 'Товары', category: 'products' },
      { name: 'Группы атрибутов', category: 'product-attribute-groups' },
      { name: 'Атрибуты', category: 'product-attributes' },
    ],
    open: false,
  },
  {
    name: 'Пользователи',
    category: 'users',
    subcategories: [],
    open: false,
  },
  { name: 'Уведомления', category: 'notify', subcategories: [], open: false },
])

const pathRefs = ref([])

// Функция для установки ref
const setPathRef = (el) => {
  if (el) {
    pathRefs.value.push(el)
  }
}
// Обработка клика по элементу меню
const handleClick = (event, item) => {
  toggleActive(event)
  goTo(item.category)
}

// Переключение активного класса
const toggleActive = (event) => {
  const link = event.target
  const items = document.querySelectorAll('.acc__link')
  items.forEach((item) => {
    item.classList.remove('active')
  })
  link.classList.add('active')
}

// Эмиссия события goTo
const goTo = (category) => {
  emit('goTo', category)
}

// Переключение подкатегорий
const toggleSubcategories = (item) => {
  menuItems.value.forEach((i) => {
    i.open = false
  })
  item.open = !item.open
}

// Определение emit для события goTo
const emit = defineEmits(['goTo'])

// Запуск анимации при монтировании
onMounted(() => {
  setTimeout(() => {
    if (pathRefs.value.length > 0) {
      startAnimation(pathRefs.value)
    }
  }, 100)
})

onUnmounted(() => {
  pathRefs.value = []
})
</script>
<template>
  <div class="sideBar__content">
    <div class="accHead">
      <a class="logo" href="/">
        <svg width="225" height="81" viewBox="0 0 225 81" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0_2921_1289)">
            <path
              d="M50.6783 19.0045C50.6783 14.3977 46.8898 10.6641 42.2151 10.6641H22.5353C18.0379 10.6641 14.3906 14.2584 14.3906 18.6907V36.6018L10.8333 33.096C8.30332 30.6027 4.19886 30.6027 1.6689 33.096C-0.861067 35.5893 -0.229217 38.2648 1.6689 42.1275L13.9052 61.6434C12.5182 61.9674 10.7382 62.5572 9.98568 63.5495C9.35383 64.3823 9.08928 65.4074 9.24082 66.4351C9.39236 67.4628 9.93945 68.374 10.7845 68.9942C11.4908 69.5156 12.3204 69.7688 13.1449 69.7688C14.347 69.7688 15.5362 69.2296 16.3119 68.2095C17.1184 67.1438 17.1415 65.0961 17.0388 63.6684H50.6783V19.0045ZM14.2879 66.7186C13.8179 67.3387 12.924 67.4653 12.2922 67.0021C11.9865 66.7768 11.7888 66.4478 11.7348 66.0782C11.6809 65.7061 11.7759 65.3365 12.0045 65.0378C12.2357 64.7417 13.3016 64.3418 14.5293 64.0557C14.5961 65.2986 14.5088 66.4199 14.2853 66.7211L14.2879 66.7186Z"
              fill="#E91111"
            />
            <path
              :ref="setPathRef"
              d="M73.3848 29.1682C73.8445 26.9407 74.1219 23.8501 74.2041 19.9823H79.1716V35.2382H83.5612V16.0234H70.0226L69.9918 19.7292C69.9353 23.9792 69.6605 27.0698 69.1802 28.9151C68.7178 30.6794 67.9935 31.5349 66.9636 31.5349C66.5372 31.5349 66.3394 31.5071 66.247 31.4868L65.9336 31.4084V35.1622L66.098 35.223C66.6425 35.4204 67.223 35.5217 67.8317 35.5217C69.2957 35.4812 70.485 34.9825 71.3634 34.0383C72.2367 33.0993 72.8968 31.5071 73.3822 29.1708L73.3848 29.1682Z"
              fill="#ffffff"
            />
            <path
              :ref="setPathRef"
              d="M91.8192 27.1561H93.761C94.0924 29.5304 95.1634 31.5352 96.9511 33.1172C98.7927 34.7499 101.017 35.5776 103.56 35.5776C103.637 35.5776 103.714 35.5776 103.791 35.5776C106.421 35.5776 108.738 34.6081 110.68 32.6945C112.621 30.7809 113.669 28.3509 113.631 25.6298C113.687 22.9087 112.701 20.5293 110.693 18.5625C108.684 16.5932 106.285 15.6263 103.565 15.682C101.176 15.682 99.0598 16.4059 97.2773 17.8361C95.5461 19.2232 94.4186 21.0254 93.9228 23.1972H91.8192V16.0237H87.4297V35.2359H91.8192V27.1536V27.1561ZM103.565 31.5352C101.957 31.5352 100.609 30.9783 99.5607 29.8823C98.5076 28.7837 97.9759 27.351 97.9759 25.6298C97.9759 23.9085 98.5102 22.4758 99.5607 21.3773C100.609 20.2812 101.955 19.7244 103.565 19.7244C105.175 19.7244 106.514 20.2838 107.551 21.3874C108.594 22.4961 109.123 23.9237 109.123 25.6272C109.123 27.3308 108.594 28.7584 107.551 29.8671C106.514 30.9707 105.17 31.5326 103.565 31.5326V31.5352Z"
              fill="#ffffff"
            />
            <path
              :ref="setPathRef"
              d="M129.315 33.5675C130.554 32.4563 131.183 30.9958 131.183 29.229C131.183 27.4622 130.559 26.0497 129.328 24.9739C128.106 23.9083 126.495 23.3666 124.543 23.3666H120.796V19.9798H129.572V16.0234H116.406V35.2356H124.543C126.48 35.2356 128.085 34.6737 129.315 33.5675ZM120.796 27.0116H124.34C125.134 27.0116 125.753 27.2141 126.182 27.609C126.613 28.0089 126.821 28.5379 126.821 29.229C126.821 29.92 126.611 30.449 126.182 30.849C125.753 31.2464 125.134 31.4463 124.34 31.4463H120.796V27.0091V27.0116Z"
              fill="#ffffff"
            />
            <path
              :ref="setPathRef"
              d="M146.244 24.0266V35.2375H150.634V15.6836H148.977L138.233 27.1223V16.0228H133.844V35.5767H135.472L146.244 24.0266Z"
              fill="#ffffff"
            />
            <path
              :ref="setPathRef"
              d="M164.02 25.6517L156.114 15.6836H154.473V35.2375H158.862V25.7175L163.265 31.1521H164.775L169.177 25.7175V35.2375H173.567V15.6836H171.926L164.02 25.6517Z"
              fill="#ffffff"
            />
            <path
              :ref="setPathRef"
              d="M185.821 15.6836H184.198L175.488 35.2375H180.212L181.278 32.7999H188.716L189.779 35.2375H194.503L185.888 15.8329L185.821 15.6836ZM187.157 29.1524H182.834L184.997 23.7558L187.16 29.1524H187.157Z"
              fill="#ffffff"
            />
            <path
              :ref="setPathRef"
              d="M198.368 17.8156C196.966 19.0128 196.252 20.5923 196.252 22.5136C196.252 23.8096 196.619 24.9866 197.346 26.0168C198.014 26.966 198.918 27.7102 200.035 28.2317L195.07 35.2382H199.858L204.289 29.029H206.379V35.2382H210.769V16.0234H203.813C201.594 16.0234 199.763 16.6259 198.368 17.813V17.8156ZM201.538 20.6278C202.082 20.1443 202.809 19.8988 203.7 19.8988H206.385V25.1587H203.7C202.809 25.1587 202.082 24.9182 201.538 24.4424C200.996 23.9665 200.731 23.3463 200.731 22.5439C200.731 21.7415 200.996 21.1138 201.54 20.6303L201.538 20.6278Z"
              fill="#ffffff"
            />
            <path
              d="M219.165 20.8135H220.488C220.555 20.8135 220.635 20.8084 220.735 20.8008L221.914 22.6031H222.805L221.508 20.6262C221.798 20.5072 222.037 20.33 222.219 20.1022C222.468 19.7908 222.594 19.4112 222.594 18.9758C222.594 18.4164 222.397 17.9658 222.004 17.6317C221.623 17.3052 221.112 17.1406 220.488 17.1406H218.418V22.6031H219.165V20.8135ZM219.153 17.8646H220.462C220.915 17.8646 221.266 17.9658 221.505 18.1633C221.734 18.3531 221.847 18.6189 221.847 18.9758C221.847 19.3327 221.736 19.5985 221.508 19.7883C221.269 19.9883 220.92 20.087 220.465 20.087H219.155V17.862L219.153 17.8646Z"
              fill="#ffffff"
            />
            <path
              d="M224.174 17.5946C223.784 16.9188 223.237 16.3796 222.548 15.9923C221.862 15.6051 221.089 15.4102 220.249 15.4102C219.41 15.4102 218.634 15.6101 217.943 16.005C217.255 16.3999 216.702 16.9441 216.307 17.625C215.911 18.3034 215.711 19.0602 215.711 19.8727C215.711 20.6853 215.911 21.4421 216.307 22.1205C216.702 22.8014 217.252 23.3456 217.935 23.738C218.621 24.1328 219.392 24.3328 220.224 24.3328C221.056 24.3328 221.829 24.1328 222.517 23.738C223.206 23.3431 223.761 22.7963 224.159 22.1129C224.559 21.4295 224.762 20.6676 224.762 19.8474C224.762 19.0273 224.565 18.2705 224.172 17.5946H224.174ZM220.249 16.1341C220.961 16.1341 221.611 16.2986 222.184 16.6201C222.754 16.9416 223.211 17.3921 223.537 17.9541C223.863 18.516 224.03 19.1539 224.03 19.8474C224.03 20.541 223.861 21.1789 223.524 21.7509C223.19 22.323 222.728 22.7812 222.15 23.1102C221.575 23.4393 220.928 23.6089 220.224 23.6089C219.52 23.6089 218.886 23.4418 218.31 23.1102C217.735 22.7812 217.273 22.3255 216.944 21.756C216.612 21.189 216.446 20.5537 216.446 19.8702C216.446 19.1868 216.612 18.5514 216.946 17.9844C217.278 17.4174 217.737 16.9618 218.318 16.6327C218.898 16.3037 219.548 16.1341 220.249 16.1341Z"
              fill="#ffffff"
            />
            <path
              :ref="setPathRef"
              d="M84.6738 45.0273H79.393L72.5146 53.259V45.0273H68.125V64.2395H72.5146V54.9296L80.2842 64.2395H85.6267L77.1892 54.0943L84.6738 45.0273Z"
              fill="#ffffff"
            />
            <path
              :ref="setPathRef"
              d="M99.4297 45.0273L95.1275 54.8511L90.4631 45.0273H85.5547L92.7388 59.5896C92.1609 60.2478 91.38 60.5667 90.3603 60.5667C89.8338 60.5667 89.3329 60.5388 88.8655 60.4832L88.5829 60.4502V64.1788L88.7653 64.2319C89.5127 64.4446 90.2627 64.5534 90.9973 64.5534C92.6823 64.5129 93.9768 64.1054 94.8424 63.3409C95.6874 62.5942 96.5787 61.2653 97.493 59.3871L104.13 45.0273H99.4297Z"
              fill="#ffffff"
            />
            <path
              :ref="setPathRef"
              d="M121.433 45.0273H116.432L112.946 50.6948L109.435 45.0273H104.404L110.491 54.4613L104.023 64.2395H109.058L112.949 58.2405L116.838 64.2395H121.844L115.435 54.4613L121.433 45.0273Z"
              fill="#ffffff"
            />
            <path
              :ref="setPathRef"
              d="M136.003 52.2009H128.104V45.0273H123.715V64.2395H128.104V56.1573H136.003V64.2395H140.39V45.0273H136.003V52.2009Z"
              fill="#ffffff"
            />
            <path
              :ref="setPathRef"
              d="M146.146 46.8169C144.741 48.0142 144.029 49.5937 144.029 51.5149C144.029 52.8084 144.396 53.988 145.123 55.0182C145.794 55.9674 146.695 56.7116 147.813 57.233L142.848 64.2395H147.635L152.066 58.0304H154.157V64.2395H158.546V45.0273H151.591C149.372 45.0273 147.54 45.6298 146.146 46.8169ZM154.157 48.8976V54.1576H151.475C150.584 54.1576 149.855 53.9171 149.313 53.4412C148.771 52.9653 148.506 52.3452 148.506 51.5428C148.506 50.7404 148.771 50.1126 149.315 49.6292C149.86 49.1457 150.587 48.9002 151.478 48.9002H154.159L154.157 48.8976Z"
              fill="#ffffff"
            />
            <path
              d="M56.5714 0C56.5714 0 58.02 3.29822 58.865 4.131C59.7101 4.96378 63.0568 6.39141 63.0568 6.39141C63.0568 6.39141 59.7101 7.81903 58.865 8.65181C58.02 9.48459 56.5714 12.7828 56.5714 12.7828C56.5714 12.7828 55.1228 9.48459 54.2777 8.65181C53.4327 7.81903 50.0859 6.39141 50.0859 6.39141C50.0859 6.39141 53.4327 4.96378 54.2777 4.131C55.1228 3.29822 56.5714 0 56.5714 0Z"
              fill="#DAA150"
            />
            <path
              d="M44.0235 36.5703C43.9927 39.2712 42.6648 41.9138 40.5021 43.873C38.3523 45.8727 35.2213 46.9155 32.2778 46.9054C29.3883 46.9003 26.2676 45.9486 24.0535 43.9616C22.9439 42.9921 22.0578 41.8201 21.4747 40.552C21.336 40.2305 21.2076 39.909 21.0869 39.5876C20.9919 39.2509 20.8789 38.9345 20.8146 38.5953C20.6631 37.9347 20.5989 37.2462 20.6503 36.5728C22.5073 38.5017 24.3592 39.9065 26.3009 40.7393C27.2693 41.1493 28.217 41.486 29.2265 41.6429C29.7119 41.7644 30.2333 41.7847 30.7367 41.8556C30.9833 41.9062 31.253 41.8859 31.5124 41.8986L32.2932 41.9366C32.5501 41.934 32.8018 41.9087 33.0587 41.9037C33.3129 41.8885 33.5749 41.9138 33.8189 41.8632C34.3146 41.7948 34.8232 41.7619 35.3061 41.6404C35.8121 41.5746 36.2744 41.3873 36.7778 41.2683C37.0218 41.1898 37.253 41.0785 37.4996 40.9949C37.7539 40.919 37.9876 40.8026 38.2265 40.6861C40.1811 39.8128 42.0689 38.4055 44.021 36.5728L44.0235 36.5703Z"
              fill="white"
            />
            <path
              d="M69.4958 76.8487C69.4958 77.2927 69.5948 77.6827 69.7928 78.0187C69.9968 78.3487 70.2608 78.6067 70.5847 78.7927C70.9088 78.9787 71.2628 79.0717 71.6468 79.0717C71.9468 79.0717 72.2168 79.0327 72.4568 78.9547C72.7028 78.8767 72.9218 78.7717 73.1137 78.6397C73.3057 78.5017 73.4738 78.3457 73.6178 78.1717V79.4407C73.3598 79.6567 73.0747 79.8217 72.7628 79.9357C72.4567 80.0497 72.0728 80.1067 71.6108 80.1067C71.1488 80.1067 70.7167 80.0287 70.3147 79.8727C69.9188 79.7167 69.5738 79.4917 69.2797 79.1977C68.9857 78.9037 68.7548 78.5587 68.5868 78.1627C68.4248 77.7607 68.3438 77.3227 68.3438 76.8487C68.3438 76.3687 68.4248 75.9307 68.5868 75.5347C68.7548 75.1327 68.9857 74.7877 69.2797 74.4997C69.5738 74.2057 69.9188 73.9807 70.3147 73.8247C70.7167 73.6627 71.1488 73.5817 71.6108 73.5817C72.0728 73.5817 72.4567 73.6387 72.7628 73.7527C73.0747 73.8667 73.3598 74.0347 73.6178 74.2567V75.5167C73.4738 75.3487 73.3057 75.1987 73.1137 75.0667C72.9218 74.9287 72.7028 74.8207 72.4568 74.7427C72.2168 74.6647 71.9468 74.6257 71.6468 74.6257C71.2628 74.6257 70.9088 74.7187 70.5847 74.9047C70.2608 75.0847 69.9968 75.3427 69.7928 75.6787C69.5948 76.0087 69.4958 76.3987 69.4958 76.8487Z"
              fill="#ffffff"
            />
            <path
              d="M76.0964 76.1647L75.6644 79.9987H74.5664L75.4304 73.3837L78.0134 77.6587L80.6054 73.3837L81.4694 79.9987H80.3714L79.9394 76.1647L78.0134 79.4137L76.0964 76.1647Z"
              fill="#ffffff"
            />
            <path
              d="M83.1684 79.9987V79.0627H86.3454V79.9987H83.1684ZM83.1684 74.6347V73.6987H86.3454V74.6347H83.1684ZM83.1684 77.0827V76.1647H86.1654V77.0827H83.1684ZM82.5114 73.6987H83.5554V79.9987H82.5114V73.6987Z"
              fill="#ffffff"
            />
            <path d="M87.023 74.6797V73.6987H91.415V74.6797H89.75V79.9987H88.688V74.6797H87.023Z" fill="#ffffff" />
            <path
              d="M92.0476 78.3787L92.2546 77.4787H95.1796L95.3776 78.3787H92.0476ZM93.6946 75.4807L92.7046 77.7937L92.6866 78.0277L91.8136 79.9987H90.6166L93.6946 73.3477L96.7816 79.9987H95.5756L94.7206 78.0817L94.7026 77.8207L93.6946 75.4807Z"
              fill="#ffffff"
            />
            <path d="M96.8485 78.2977V77.4247H98.6935V78.2977H96.8485Z" fill="#ffffff" />
            <path
              d="M100.609 76.1647L100.177 79.9987H99.0791L99.9431 73.3837L102.526 77.6587L105.118 73.3837L105.982 79.9987H104.884L104.452 76.1647L102.526 79.4137L100.609 76.1647Z"
              fill="#ffffff"
            />
            <path
              d="M108.053 78.3787L108.26 77.4787H111.185L111.383 78.3787H108.053ZM109.7 75.4807L108.71 77.7937L108.692 78.0277L107.819 79.9987H106.622L109.7 73.3477L112.787 79.9987H111.581L110.726 78.0817L110.708 77.8207L109.7 75.4807Z"
              fill="#ffffff"
            />
            <path
              d="M113.51 73.6987H114.572V79.9987H113.51V73.6987ZM114.14 74.6347V73.6987H115.409C115.871 73.6987 116.27 73.7797 116.606 73.9417C116.942 74.0977 117.203 74.3227 117.389 74.6167C117.581 74.9047 117.677 75.2497 117.677 75.6517C117.677 76.0537 117.581 76.4017 117.389 76.6957C117.203 76.9897 116.942 77.2177 116.606 77.3797C116.27 77.5357 115.871 77.6137 115.409 77.6137H114.14V76.6777H115.409C115.775 76.6777 116.069 76.5907 116.291 76.4167C116.513 76.2427 116.624 75.9877 116.624 75.6517C116.624 75.3157 116.513 75.0637 116.291 74.8957C116.069 74.7217 115.775 74.6347 115.409 74.6347H114.14Z"
              fill="#ffffff"
            />
            <path
              d="M118.714 73.6987H119.803V79.9987H118.714V73.6987ZM122.143 73.6987H123.43L120.766 76.6507L123.565 79.9987H122.251L119.488 76.6777L122.143 73.6987Z"
              fill="#ffffff"
            />
            <path
              d="M124.943 79.9987V79.0627H128.12V79.9987H124.943ZM124.943 74.6347V73.6987H128.12V74.6347H124.943ZM124.943 77.0827V76.1647H127.94V77.0827H124.943ZM124.286 73.6987H125.33V79.9987H124.286V73.6987Z"
              fill="#ffffff"
            />
            <path
              d="M128.797 74.6797V73.6987H133.189V74.6797H131.524V79.9987H130.462V74.6797H128.797Z"
              fill="#ffffff"
            />
          </g>
          <defs>
            <clipPath id="clip0_2921_1289">
              <rect width="225" height="81" fill="white" />
            </clipPath>
          </defs>
        </svg>
      </a>
      <div class="head-text">Административная панель</div>
    </div>
    <div class="accBody">
      <div v-for="item in menuItems" :key="item.category">
        <a
          @click="[
            toggleSubcategories(item),
            handleClick($event, {
              category: item.category,
            }),
          ]"
          class="acc__link"
          :class="{ active: item.open }"
        >
          {{ item.name }}
        </a>
        <!-- Подкатегории -->
        <div v-if="item.open" class="subcategories">
          <a
            v-for="(sub, index) in item.subcategories"
            :key="index"
            @click="
              handleClick($event, {
                category: sub.category,
              })
            "
            class="acc__link sub-link"
          >
            {{ sub.name }}
          </a>
        </div>
      </div>
    </div>
  </div>
</template>

<style scoped>
.sideBar__content {
  display: flex;
  flex-direction: column;
  gap: 64px;
  padding: 42px 51px;
  align-items: center;
}
.accHead {
  display: flex;
  flex-direction: column;
  gap: 14px;
  width: 100%;
}
.head-text {
  color: #fff;
  font-size: 16px;
  font-style: normal;
  font-weight: 700;
  line-height: normal;
}
.accBody {
  display: flex;
  flex-direction: column;
  gap: 23px;
  width: 100%;
}
.acc__link {
  position: relative;
  color: #fff;
  font-size: 16px;
  font-style: normal;
  font-weight: 700;
  line-height: normal;
  padding-bottom: 10px;
  cursor: pointer;
}
.acc__link.active::before {
  content: '';
  position: absolute;
  bottom: 5px;
  left: 0;
  width: 28px;
  height: 2px;
  background: #fff;
}
.subcategories {
  display: flex;
  flex-direction: column;
  padding-left: 20px;
  gap: 10px;
  margin-top: 10px;
}
.sub-link {
  font-weight: 400;
  color: #ddd;
}
</style>
